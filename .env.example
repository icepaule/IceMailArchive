# =============================================================================
# IceMailArchive - Konfiguration
# =============================================================================
# Kopieren nach .env und Werte anpassen:
#   cp .env.example .env
#   nano .env
#
# Geheimnisse generieren:
#   openssl rand -hex 32    (fuer 256-bit Keys)
#   openssl rand -base64 16 (fuer Passwoerter)
# =============================================================================

# --- Anwendung ---
NODE_ENV=production
PORT_BACKEND=4000
PORT_FRONTEND=3000
# URL unter der OpenArchiver erreichbar ist (IP oder Hostname)
APP_URL=http://YOUR_SERVER_IP:3000
ORIGIN=http://YOUR_SERVER_IP:3000

# Sync-Frequenz (Cron-Syntax): alle 5 Minuten
SYNC_FREQUENCY='*/5 * * * *'
# Junk/Trash-Ordner mitarchivieren? (false = sauberes Archiv)
ALL_INCLUSIVE_ARCHIVE=false

# --- PostgreSQL ---
POSTGRES_DB=open_archive
POSTGRES_USER=archiver
POSTGRES_PASSWORD=CHANGE_ME_postgres_password
DATABASE_URL="postgresql://archiver:CHANGE_ME_postgres_password@127.0.0.1:5432/open_archive"

# --- Meilisearch (Volltextsuche) ---
MEILI_MASTER_KEY=CHANGE_ME_meilisearch_key
MEILI_HOST=http://127.0.0.1:7700
MEILI_INDEXING_BATCH=500

# --- Redis/Valkey (Job-Queue + Cache) ---
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_ME_redis_password
REDIS_TLS_ENABLED=false

# --- Email-Speicher ---
STORAGE_TYPE=local
BODY_SIZE_LIMIT=Infinity
# Pfad INNERHALB des Containers (wird via Volume gemappt)
STORAGE_LOCAL_ROOT_PATH=/var/data/open-archiver
# Pfad auf dem HOST (docker-compose Volume)
STORAGE_HOST_PATH=/data/openarchiver/storage

# --- Verschluesselung ---
# AES-256 fuer gespeicherte Emails (openssl rand -hex 32)
STORAGE_ENCRYPTION_KEY=CHANGE_ME_64_hex_chars_storage_encryption
# Master-Key fuer IMAP-Credentials (openssl rand -hex 32)
ENCRYPTION_KEY=CHANGE_ME_64_hex_chars_encryption

# --- Sicherheit ---
ENABLE_DELETION=true
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
# JWT fuer API-Auth (openssl rand -hex 32)
JWT_SECRET=CHANGE_ME_64_hex_chars_jwt
JWT_EXPIRES_IN="7d"

# --- Node.js ---
# IPv4 bevorzugen (falls IPv6 nicht geroutet wird)
NODE_OPTIONS=--dns-result-order=ipv4first
# Selbstsignierte Zertifikate erlauben (fuer Proton Bridge TLS-Wrapper)
NODE_TLS_REJECT_UNAUTHORIZED=0

# --- Apache Tika (Anhang-Textextraktion) ---
TIKA_URL=http://127.0.0.1:9998

# --- Proton Bridge TLS-Wrapper (optional) ---
# CA-Zertifikat fuer den TLS-Wrapper (Pfad auf dem Host)
# PROTON_CA_CERT=./proton-tls.crt
